<mat-dialog-content>
    <div class="container">
        <h3 mat-dialog-title>{{getPageTitle()}}</h3>
        <app-notification></app-notification>
        <form [formGroup]="service.itemForm">
            <mat-form-field class="maxWidth" appearance="outline">
                <mat-label>Item ID</mat-label>
                <input matInput formControlName="id" type="text" readonly>
            </mat-form-field>

            <mat-checkbox [(ngModel)]="service.currentItemIsFeatured" [ngModelOptions]="{standalone: true}">Featured Item?</mat-checkbox>              

            <mat-form-field class="maxWidth" appearance="outline">
                <mat-label>Item Code</mat-label>
                <input matInput formControlName="code" type="text">
            </mat-form-field>
            <div class="validationMessages">
                <div *ngIf="service.itemForm.controls.code.touched 
                          && service.itemForm.controls.code.errors 
                          && service.itemForm.controls.code.errors.failedPopulation">
                    Code is mandatory.
                </div>
                <div *ngIf="
                          service.itemForm.controls.code.touched 
                          && service.itemForm.controls.code.errors 
                          && service.itemForm.controls.code.errors.failedMinLength">
                    Code should be 2 or more characters.
                </div>
                <div *ngIf="
                          service.itemForm.controls.code.touched 
                          && service.itemForm.controls.code.errors 
                          && service.itemForm.controls.code.errors.failedMaxLength">
                    Code can't be more than 7 characters.
                </div>
            </div>

            <mat-form-field class="maxWidth" appearance="outline">
                <mat-label>Item Name</mat-label>
                <input matInput formControlName="name" type="text">
            </mat-form-field>
            <div class="validationMessages">
                <div *ngIf="service.itemForm.controls.name.touched 
                  && service.itemForm.controls.name.errors 
                  && service.itemForm.controls.name.errors.failedPopulation">
                    Name is mandatory.
                </div>
            </div>


            <input type="file" #fileSelector style="display: none" (change)="fileSelected($event)" />
            <button mat-raised-button color="primary" class="maxWidth" (click)="uploadClicked()">Select File</button>
            <img #currentImage [src]="service.imageSrc || 'http://placehold.it/160'" alt="itemImage" style="max-width: 100%;">


            <mat-form-field class="maxWidth" appearance="outline">
                <mat-label>Item Description</mat-label>
                <input matInput formControlName="desc" type="text">
            </mat-form-field>
            <div class="validationMessages">
                <div *ngIf="
                  service.itemForm.controls.desc.touched 
                  && service.itemForm.controls.desc.errors 
                  && service.itemForm.controls.desc.errors.failedPopulation">
                    Description is mandatory.
                </div>
            </div>

            <div flex fxLayout="row" fxLayout.lt-md="column" fxLayoutGap="10px" fxLayoutAlign="center">
                <div fxFlex="50">

                    <button mat-raised-button color="primary" type="button" class="maxWidth" (click)="openChildSelect()">
                        Sub Group Selector
                    </button>
                </div>
                <div fxFlex="50">
                    <mat-form-field class="maxWidth">
                        <mat-label>Use Sub Group Selector Button</mat-label>
                        <input matInput formControlName="subID" type="text" readonly hidden>
                        <input matInput formControlName="subText" type="text" readonly>
                    </mat-form-field>
                </div>
            </div>


            <mat-form-field class="maxWidth" appearance="outline">
                <mat-label>Item Unit Price</mat-label>
                <input matInput formControlName="unitPrice" type="number">
            </mat-form-field>
            <div class="validationMessages">
                <div *ngIf="
                          service.itemForm.controls.unitPrice.touched 
                          && service.itemForm.controls.unitPrice.errors 
                          && service.itemForm.controls.unitPrice.errors.failedPopulation">
                    Unit Price is mandatory.
                </div>
            </div>

            <mat-form-field class="maxWidth" appearance="outline">
                <mat-label>Minimum Price After Discount</mat-label>
                <input matInput formControlName="unitPriceAD" type="number">
            </mat-form-field>
            <div class="validationMessages">
                <div *ngIf="
                              service.itemForm.controls.unitPriceAD.touched 
                              && service.itemForm.controls.unitPriceAD.errors 
                              && service.itemForm.controls.unitPriceAD.errors.failedPopulation">
                    Minimum price is mandatory.
                </div>
            </div>

            <mat-form-field class="maxWidth" appearance="outline">
                <mat-label>Current Available Stock Level</mat-label>
                <input matInput formControlName="availableQty" type="number">
            </mat-form-field>
            <div class="validationMessages">
                <div *ngIf="
                                  service.itemForm.controls.availableQty.touched 
                                  && service.itemForm.controls.availableQty.errors 
                                  && service.itemForm.controls.availableQty.errors.failedPopulation">
                    Qty is mandatory
                </div>
            </div>

            <mat-form-field class="maxWidth" appearance="outline">
                <mat-label>Item Reorder Qty Reminder</mat-label>
                <input matInput formControlName="reorderQty" type="number">
            </mat-form-field>
            <div class="validationMessages">
                <div *ngIf="
                                      service.itemForm.controls.reorderQty.touched 
                                      && service.itemForm.controls.reorderQty.errors 
                                      && service.itemForm.controls.reorderQty.errors.failedPopulation">
                    Reminder Qty is Mandatory
                </div>
            </div>
            <div flex fxLayout="row" fxLayout.lt-md="column" fxLayoutGap="10px" fxLayoutAlign="center">
                <div fxFlex="50">
                    <button mat-raised-button color="accent" type="submit" class="maxWidth" (click)="submit()">{{getSubmitButtonText()}}</button>
                </div>
                <div fxFlex="50">
                    <button mat-raised-button color="primary" class="maxWidth" (click)="cancel()">Close</button>
                </div>
            </div>
        </form>
    </div>
</mat-dialog-content>